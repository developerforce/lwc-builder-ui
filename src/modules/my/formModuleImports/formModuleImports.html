<template>
  <ul>
    <template for:each={modules} for:item="c">
      <li key={c.category.id} class="slds-m-bottom_medium">
        <template if:true={c.category.label}>
          <h1 class="slds-m-bottom_x-small category-title">
            {c.category.label}
          </h1>
        </template>
        <ul>
          <template for:each={c.modules} for:item="m">
            <li key={m.value} class="slds-m-bottom_small">
              <div class="slds-form-element">
                <div class="slds-form-element__control">
                  <div class="slds-checkbox">
                    <input
                      type="checkbox"
                      name={m.value}
                      id={m.value}
                      value={m.value}
                      checked={m.checked}
                      onchange={onChangeCheckbox}
                    />
                    <label class="slds-checkbox__label" for={m.value}>
                      <span class="slds-checkbox_faux"></span>
                      <span class="slds-form-element__label"> {m.label} </span>
                    </label>
                    <template if:true={m.url}>
                      <span class="help-url">
                        <a href={m.url} target="_blank">
                          <svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 52 52"
                          >
                            <path
                              d="M26 2C12.7 2 2 12.7 2 26s10.7 24 24 24 24-10.7 24-24S39.3 2 26 2zm0 12.1c1.7 0 3 1.3 3 3s-1.3 3-3 3-3-1.3-3-3 1.3-3 3-3zm5 21c0 .5-.4.9-1 .9h-8c-.5 0-1-.3-1-.9v-2c0-.5.4-1.1 1-1.1.5 0 1-.3 1-.9v-4c0-.5-.4-1.1-1-1.1-.5 0-1-.3-1-.9v-2c0-.5.4-1.1 1-1.1h6c.5 0 1 .5 1 1.1v8c0 .5.4.9 1 .9.5 0 1 .5 1 1.1v2z"
                            ></path>
                          </svg>
                        </a>
                      </span>
                    </template>
                    <template if:true={m.help}>
                      <span class="slds-m-left_x-small module-import-help">
                        {m.help}
                      </span>
                    </template>
                  </div>
                </div>
              </div>
              <template if:true={m.checked}>
                <template if:true={m.submodules}>
                  <ul
                    class="
                      slds-box
                      slds-m-left_large
                      slds-m-top_x-small
                      slds-m-bottom_small
                      module-submodule-list
                    "
                  >
                    <template if:true={m.submoduleLabel}>
                      <h1 class="slds-m-bottom_xx-small submodule-title">
                        {m.submoduleLabel}
                      </h1>
                    </template>
                    <template for:each={m.submodules} for:item="sm">
                      <li key={sm.id}>
                        <div class="slds-form-element">
                          <div class="slds-form-element__control">
                            <div class="slds-checkbox">
                              <input
                                type="checkbox"
                                name={sm.id}
                                id={sm.id}
                                value={sm.id}
                                checked={sm.checked}
                                onchange={onChangeSubmoduleCheckbox}
                              />
                              <label class="slds-checkbox__label" for={sm.id}>
                                <span class="slds-checkbox_faux"></span>
                                <span class="slds-form-element__label">
                                  {sm.label}
                                </span>
                              </label>
                            </div>
                          </div>
                        </div>
                      </li>
                    </template>
                  </ul>
                </template>

                <template if:true={m.preferences}>
                  <ul
                    class="
                      slds-box
                      slds-m-left_large
                      slds-m-top_x-small
                      slds-m-bottom_small
                      module-preference-list
                    "
                  >
                    <template for:each={m.preferences} for:item="pf">
                      <li
                        key={pf.id}
                        class="slds-m-bottom_x-small slds-m-right_medium"
                      >
                        <fieldset class="slds-form-element">
                          <legend
                            class="
                              slds-form-element__legend slds-form-element__label
                            "
                          >
                            {pf.label}
                          </legend>
                          <div class="slds-form-element__control">
                            <div class="slds-radio_button-group">
                              <template for:each={pf.options} for:item="o">
                                <span
                                  key={o.value}
                                  class="slds-button slds-radio_button"
                                >
                                  <input
                                    type="radio"
                                    name={pf.id}
                                    id={o.value}
                                    value={o.value}
                                    onchange={onChangePreference}
                                  />
                                  <label
                                    class="slds-radio_button__label"
                                    for={o.value}
                                  >
                                    <span class="slds-radio_faux"
                                      >{o.label}</span
                                    >
                                  </label>
                                </span>
                              </template>
                            </div>
                          </div>
                        </fieldset>
                      </li>
                    </template>
                  </ul>
                </template>
              </template>
            </li>
          </template>
        </ul>
      </li>
    </template>
  </ul>
</template>
